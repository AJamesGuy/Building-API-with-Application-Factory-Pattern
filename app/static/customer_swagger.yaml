swagger: '2.0'
info:
  title: 'Customer Management API'
  description: 'API for managing customer accounts'
  version: '1.0.0'

host: 'https://my-mechanics.onrender.com'
schemes:
  - 'https'
consumes:
  - 'application/json'
produces:
  - 'application/json'

securityDefinitions:
  bearerAuth:
    type: apiKey
    name: Authorization
    in: header
    description: 'JWT token for authentication'

paths:

  /customers/login:
    post:
      tags:
        - Customers
      summary: "Login endpoint for customers"
      description: "Validates customers' email and password for login. Returns an authentication token."
      parameters:
        - in: "body"
          name: "body"
          description: "Login Credentials"
          required: true
          schema:
            $ref: "#/definitions/CustomerLoginCredentials"
      responses:
        200:
          description: "Login Successful"
          schema:
            $ref: "#/definitions/CustomerLoginResponse"
          examples:
            application/json:
              message: "Welcome John!"
              token: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        400:
          description: "Invalid email or password"
          schema:
            $ref: "#/definitions/ErrorResponse"

  /customers:
    post:
      tags:
        - Customers
      summary: "Create new customer"
      description: "Create a new customer account (rate limited to 30 per day)"
      parameters:
        - in: "body"
          name: "body"
          description: "New customer information"
          required: true
          schema:
            $ref: "#/definitions/CustomerInput"
      responses:
        201:
          description: "Creation Successful"
          schema:
            $ref: "#/definitions/CustomerResponse"
          examples:
            application/json:
              id: 1
              first_name: "John"
              last_name: "Doe"
              email: "john.doe@example.com"
              phone: "555-1234"
        400:
          description: "Validation Error"
          schema:
            $ref: "#/definitions/ErrorResponse"

  /customers/read-customers:
    get:
      tags:
        - Customers
      summary: "Get all customers utilizing Pagination"
      description: "Retrieve a paginated list of all customer objects"
      security:
        - bearerAuth: []
      parameters:
        - in: "query"
          name: "page"
          type: integer
          description: "Page number (starts at 1)"
          required: false
          default: 1
        - in: "query"
          name: "per_page"
          type: integer
          description: "Items per page"
          required: false
          default: 10
      responses:
        200:
          description: "Successful Retrieval of Customers"
          schema:
            $ref: "#/definitions/PaginatedCustomerResponse"
          examples:
            application/json:
              items:
                - id: 1
                  first_name: "John"
                  last_name: "Doe"
                  email: "john.doe@example.com"
                  phone: "555-1234"
                - id: 2
                  first_name: "Jane"
                  last_name: "Smith"
                  email: "jane.smith@example.com"
                  phone: "555-5678"
              total: 50
              page: 1
              per_page: 10
              pages: 5
        401:
          description: "Token missing or invalid"
          schema:
            $ref: "#/definitions/ErrorResponse"
        500:
          description: "Error retrieving customer objects"
          schema:
            $ref: "#/definitions/ErrorResponse"

  /customers/{customer_id}/update-customer:
    put:
      tags:
        - Customers
      summary: "Update Customer Account"
      description: "Update the account of the logged in Customer (only your own account)"
      security:
        - bearerAuth: []
      parameters:
        - in: "path"
          name: "customer_id"
          type: integer
          required: true
          description: "Customer ID to update"
        - in: "body"
          name: "body"
          description: "Customer Updates"
          required: true
          schema:
            $ref: "#/definitions/CustomerInput"
      responses:
        200:
          description: "Customer updated Successfully"
          schema:
            $ref: "#/definitions/CustomerResponse"
          examples:
            application/json:
              id: 1
              first_name: "John"
              last_name: "Doe"
              email: "john.doe@example.com"
              phone: "555-1234"
        403:
          description: "Unauthorized attempt to update account of another Customer"
          schema:
            $ref: "#/definitions/ErrorResponse"
        404:
          description: "Customer not found"
          schema:
            $ref: "#/definitions/ErrorResponse"

  /customers/{customer_id}/delete-customer:
    delete:
      tags:
        - Customers
      summary: "Delete Customer Account"
      description: "Delete a customer account (only your own account)"
      security:
        - bearerAuth: []
      parameters:
        - in: "path"
          name: "customer_id"
          type: integer
          required: true
          description: "Customer ID to delete"
      responses:
        200:
          description: "Customer deleted successfully"
          schema:
            $ref: "#/definitions/MessageResponse"
          examples:
            application/json:
              message: "Customer deleted successfully"
        403:
          description: "Unauthorized - can only delete own account"
          schema:
            $ref: "#/definitions/ErrorResponse"
        404:
          description: "Customer not found"
          schema:
            $ref: "#/definitions/ErrorResponse"

  /customers/search-customer:
    get:
      tags:
        - Customers
      summary: "Search customer by email"
      description: "Search for a specific customer by email address"
      security:
        - bearerAuth: []
      parameters:
        - in: "body"
          name: "body"
          description: "Email to search"
          required: true
          schema:
            $ref: "#/definitions/CustomerLoginCredentials"
      responses:
        200:
          description: "Customer found"
          schema:
            type: object
            properties:
              Customer ID:
                type: integer
              First Name:
                type: string
              Last Name:
                type: string
              Email:
                type: string
              Phone:
                type: string
          examples:
            application/json:
              Customer ID: 1
              First Name: "John"
              Last Name: "Doe"
              Email: "john.doe@example.com"
              Phone: "555-1234"
        404:
          description: "Customer not found"
          schema:
            $ref: "#/definitions/ErrorResponse"

definitions:

  CustomerLoginCredentials:
    type: object
    required:
      - email
      - password
    properties:
      email:
        type: string
        format: email
        example: "john.doe@example.com"
      password:
        type: string
        format: password
        example: "password123"

  CustomerLoginResponse:
    type: object
    properties:
      message:
        type: string
        example: "Welcome John!"
      token:
        type: string
        example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."

  CustomerInput:
    type: object
    required:
      - first_name
      - last_name
      - email
      - password
      - phone
    properties:
      first_name:
        type: string
        example: "John"
      last_name:
        type: string
        example: "Doe"
      email:
        type: string
        format: email
        example: "john.doe@example.com"
      password:
        type: string
        format: password
        example: "password123"
      phone:
        type: string
        example: "555-1234"
      address:
        type: string
        example: "123 Main St, City, State"

  CustomerResponse:
    type: object
    properties:
      id:
        type: integer
        example: 1
      first_name:
        type: string
        example: "John"
      last_name:
        type: string
        example: "Doe"
      email:
        type: string
        example: "john.doe@example.com"
      phone:
        type: string
        example: "555-1234"
      address:
        type: string
        example: "123 Main St, City, State"

  PaginatedCustomerResponse:
    type: object
    properties:
      items:
        type: array
        items:
          $ref: "#/definitions/CustomerResponse"
      total:
        type: integer
        example: 50
      page:
        type: integer
        example: 1
      per_page:
        type: integer
        example: 10
      pages:
        type: integer
        example: 5

  ErrorResponse:
    type: object
    properties:
      error:
        type: string
        example: "Not found"

  MessageResponse:
    type: object
    properties:
      message:
        type: string
        example: "Success"
    

            


          

        
